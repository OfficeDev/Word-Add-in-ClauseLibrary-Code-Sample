/*!
 * async
 * https://github.com/caolan/async
 *
 * Copyright 2010-2014 Caolan McMahon
 * Released under the MIT license
 */
(function(){function t(){}function h(n){var t=!1;return function(){if(t)throw new Error("Callback was already called.");t=!0;n.apply(this,arguments)}}function e(n){var t=!1;return function(){t||(t=!0,n.apply(this,arguments))}}function c(n){return f(n)||typeof n.length=="number"&&n.length>=0&&n.length%1==0}function ct(n,t){return c(n)?r(n,t):at(n,t)}function r(n,t){for(var i=-1,r=n.length;++i<r;)t(n[i],i,n)}function u(n,t){for(var i=-1,r=n.length,u=Array(r);++i<r;)u[i]=t(n[i],i,n);return u}function g(n){return u(Array(n),function(n,t){return t})}function lt(n,t,i){return r(n,function(n,r,u){i=t(i,n,r,u)}),i}function at(n,t){r(o(n),function(i){t(n[i],i)})}function nt(n){var t=-1,i,r;return c(n)?(i=n.length,function(){return t++,t<i?t:null}):(r=o(n),i=r.length,function(){return t++,t<i?r[t]:null})}function i(n,t){var r,i,u;for(t=t||0,r=-1,i=n.length,t&&(i-=t,i=i<0?0:i),u=Array(i);++r<i;)u[r]=n[r+t];return u}function p(n){return function(t,i,r){return n(t,r)}}function y(n){return function(i,r,u){var o;if(u=e(u||t),i=i||[],o=nt(i),n<=0)return u(null);var s=!1,f=0,c=!1;(function l(){if(s&&f<=0)return u(null);while(f<n&&!c){var t=o();if(t===null){s=!0;f<=0&&u(null);return}f+=1;r(i[t],t,h(function(n){f-=1;n?(u(n),c=!0):l()}))}})()}}function a(t){return function(i,r,u){return t(n.eachOf,i,r,u)}}function vt(n,t){return function(i,r,u){return t(y(n),i,r,u)}}function v(t){return function(i,r,u){return t(n.eachOfSeries,i,r,u)}}function w(n,i,r,u){u=e(u||t);var f=[];n(i,function(n,t,i){r(n,function(n,r){f[t]=r;i(n)})},function(n){u(n,f)})}function yt(n){return vt(n,w)}function tt(n,t,i,r){var f=[];t=u(t,function(n,t){return{index:t,value:n}});n(t,function(n,t,r){i(n.value,function(t){t&&f.push(n);r()})},function(){r(u(f.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})}function it(n,t,i,r){var f=[];t=u(t,function(n,t){return{index:t,value:n}});n(t,function(n,t,r){i(n.value,function(t){t||f.push(n);r()})},function(){r(u(f.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})}function rt(n,i,r,u){n(i,function(n,i,f){r(n,function(i){i?(u(n),u=t):f()})},function(){u()})}function ut(n,r,u){u=u||t;var f=c(r)?[]:{};n(r,function(n,t,r){n(function(n){var u=i(arguments,1);u.length<=1&&(u=u[0]);f[t]=u;r(n)})},function(n){u(n,f)})}function ft(n,t,i,r){var u=[];n(t,function(n,t,r){i(n,function(n,t){u=u.concat(t||[]);r(n)})},function(n){r(n,u)})}function et(i,e,o){function l(i,u,e,o){if(o!=null&&typeof o!="function")throw new Error("task callback must be a function");if(i.started=!0,f(u)||(u=[u]),u.length===0&&i.idle())return n.setImmediate(function(){i.drain()});r(u,function(n){var r={data:n,callback:o||t};e?i.tasks.unshift(r):i.tasks.push(r);i.tasks.length===i.concurrency&&i.saturated()});n.setImmediate(i.process)}function a(n,t){return function(){c-=1;var i=arguments;r(t,function(n){n.callback.apply(n,i)});n.tasks.length+c===0&&n.drain();n.process()}}if(e==null)e=1;else if(e===0)throw new Error("Concurrency must not be zero");var c=0,s={tasks:[],concurrency:e,saturated:t,empty:t,drain:t,started:!1,paused:!1,push:function(n,t){l(s,n,!1,t)},kill:function(){s.drain=t;s.tasks=[]},unshift:function(n,t){l(s,n,!0,t)},process:function(){var n,t,r;if(!s.paused&&c<s.concurrency&&s.tasks.length)while(c<s.concurrency&&s.tasks.length)n=o?s.tasks.splice(0,o):s.tasks.splice(0,s.tasks.length),t=u(n,function(n){return n.data}),s.tasks.length===0&&s.empty(),c+=1,r=h(a(s,n)),i(t,r)},length:function(){return s.tasks.length},running:function(){return c},idle:function(){return s.tasks.length+c===0},pause:function(){s.paused=!0},resume:function(){var i,t;if(s.paused!==!1)for(s.paused=!1,i=Math.min(s.concurrency,s.tasks.length),t=1;t<=i;t++)n.setImmediate(s.process)}};return s}function ot(n){return function(t){var u=i(arguments,1);t.apply(null,u.concat([function(t){var u=i(arguments,1);typeof console!="undefined"&&(t?console.error&&console.error(t):console[n]&&r(u,function(t){console[n](t)}))}]))}}function st(n){return function(t,i,r){n(g(t),i,r)}}function ht(n,t){function r(){var u=this,r=i(arguments),f=r.pop();return n(t,function(n,t,i){n.apply(u,r.concat([i]))},f)}if(arguments.length>2){var u=i(arguments,2);return r.apply(this,u)}return r}function b(t){return function(){var r=i(arguments),f=r.pop(),u;r.push(function(){var t=arguments;u?n.setImmediate(function(){f.apply(null,t)}):f.apply(null,t)});u=!0;t.apply(this,r);u=!1}}var n={},s,k,d,f,o,l;s=typeof window=="object"&&this===window?window:typeof global=="object"&&this===global?global:this;s!=null&&(k=s.async);n.noConflict=function(){return s.async=k,n};d=Object.prototype.toString;f=Array.isArray||function(n){return d.call(n)==="[object Array]"};o=Object.keys||function(n){var t=[];for(var i in n)n.hasOwnProperty(i)&&t.push(i);return t};typeof setImmediate=="function"&&(l=setImmediate);typeof process!="undefined"&&process.nextTick?(n.nextTick=process.nextTick,n.setImmediate=l?function(n){l(n)}:n.nextTick):l?(n.nextTick=function(n){l(n)},n.setImmediate=n.nextTick):(n.nextTick=function(n){setTimeout(n,0)},n.setImmediate=n.nextTick);n.forEach=n.each=function(t,i,r){return n.eachOf(t,p(i),r)};n.forEachSeries=n.eachSeries=function(t,i,r){return n.eachOfSeries(t,p(i),r)};n.forEachLimit=n.eachLimit=function(n,t,i,r){return y(t)(n,p(i),r)};n.forEachOf=n.eachOf=function(n,i,r){function s(n){n?r(n):(f+=1,f>=u&&r(null))}r=e(r||t);n=n||[];var u=c(n)?n.length:o(n).length,f=0;if(!u)return r(null);ct(n,function(t,r){i(n[r],r,h(s))})};n.forEachOfSeries=n.eachOfSeries=function(i,r,u){function o(){var t=!0;if(f===null)return u(null);r(i[f],f,h(function(i){if(i)u(i);else{if(f=s(),f===null)return u(null);t?n.nextTick(o):o()}}));t=!1}u=e(u||t);i=i||[];var s=nt(i),f=s();o()};n.forEachOfLimit=n.eachOfLimit=function(n,t,i,r){y(t)(n,i,r)};n.map=a(w);n.mapSeries=v(w);n.mapLimit=function(n,t,i,r){return yt(t)(n,i,r)};n.inject=n.foldl=n.reduce=function(t,i,r,u){n.eachOfSeries(t,function(n,t,u){r(i,n,function(n,t){i=t;u(n)})},function(n){u(n||null,i)})};n.foldr=n.reduceRight=function(t,i,r,f){var e=u(t,function(n){return n}).reverse();n.reduce(e,i,r,f)};n.select=n.filter=a(tt);n.selectSeries=n.filterSeries=v(tt);n.reject=a(it);n.rejectSeries=v(it);n.detect=a(rt);n.detectSeries=v(rt);n.any=n.some=function(i,r,u){n.eachOf(i,function(n,i,f){r(n,function(n){n&&(u(!0),u=t);f()})},function(){u(!1)})};n.all=n.every=function(i,r,u){n.eachOf(i,function(n,i,f){r(n,function(n){n||(u(!1),u=t);f()})},function(){u(!0)})};n.sortBy=function(t,i,r){function f(n,t){var i=n.criteria,r=t.criteria;return i<r?-1:i>r?1:0}n.map(t,function(n,t){i(n,function(i,r){i?t(i):t(null,{value:n,criteria:r})})},function(n,t){if(n)return r(n);r(null,u(t.sort(f),function(n){return n.value}))})};n.auto=function(u,s){function v(n){c.unshift(n)}function y(n){for(var t=0;t<c.length;t+=1)if(c[t]===n){c.splice(t,1);return}}function p(){l--;r(c.slice(0),function(n){n()})}var a,l,h,c;if(s=e(s||t),a=o(u),l=a.length,!l)return s(null);h={};c=[];v(function(){l||s(null,h)});r(a,function(t){function a(u){var f=i(arguments,1),e;f.length<=1&&(f=f[0]);u?(e={},r(o(h),function(n){e[n]=h[n]}),e[t]=f,s(u,e)):(h[t]=f,n.setImmediate(p))}function b(){return lt(c,function(n,t){return n&&h.hasOwnProperty(t)},!0)&&!h.hasOwnProperty(t)}function k(){b()&&(y(k),e[e.length-1](a,h))}for(var e=f(u[t])?u[t]:[u[t]],c=e.slice(0,Math.abs(e.length-1))||[],w=c.length,l;w--;){if(!(l=u[c[w]]))throw new Error("Has inexistant dependency");if(f(l)&&!!~l.indexOf(t))throw new Error("Has cyclic dependencies");}b()?e[e.length-1](a,h):v(k)})};n.retry=function(t,i,r){function e(u,e){function o(n,t){return function(i){n(function(n,r){i(!n||t,{err:n,result:r})},e)}}while(t)f.push(o(i,!(t-=1)));n.series(f,function(n,t){t=t[t.length-1];(u||r)(t.err,t.result)})}var u=5,f=[];return typeof t=="function"&&(r=i,i=t,t=u),t=parseInt(t,10)||u,r?e():e};n.waterfall=function(r,u){function o(n){return function(t){if(t)u.apply(null,arguments);else{var r=i(arguments,1),f=n.next();f?r.push(o(f)):r.push(u);b(n).apply(null,r)}}}if(u=e(u||t),!f(r)){var s=new Error("First argument to waterfall must be an array of functions");return u(s)}if(!r.length)return u();o(n.iterator(r))()};n.parallel=function(t,i){ut(n.eachOf,t,i)};n.parallelLimit=function(n,t,i){ut(y(t),n,i)};n.series=function(r,u){u=u||t;var f=c(r)?[]:{};n.eachOfSeries(r,function(n,t,r){n(function(n){var u=i(arguments,1);u.length<=1&&(u=u[0]);f[t]=u;r(n)})},function(n){u(n,f)})};n.iterator=function(n){function t(i){function r(){return n.length&&n[i].apply(null,arguments),r.next()}return r.next=function(){return i<n.length-1?t(i+1):null},r}return t(0)};n.apply=function(n){var t=i(arguments,1);return function(){return n.apply(null,t.concat(i(arguments)))}};n.concat=a(ft);n.concatSeries=v(ft);n.whilst=function(t,i,r){t()?i(function(u){if(u)return r(u);n.whilst(t,i,r)}):r(null)};n.doWhilst=function(t,r,u){t(function(f){if(f)return u(f);var e=i(arguments,1);r.apply(null,e)?n.doWhilst(t,r,u):u(null)})};n.until=function(t,i,r){t()?r(null):i(function(u){if(u)return r(u);n.until(t,i,r)})};n.doUntil=function(t,r,u){t(function(f){if(f)return u(f);var e=i(arguments,1);r.apply(null,e)?u(null):n.doUntil(t,r,u)})};n.queue=function(n,t){return et(function(t,i){n(t[0],i)},t,1)};n.priorityQueue=function(i,u){function o(n,t){return n.priority-t.priority}function s(n,t,i){for(var r=-1,f=n.length-1,u;r<f;)u=r+(f-r+1>>>1),i(t,n[u])>=0?r=u:f=u-1;return r}function h(i,u,e,h){if(h!=null&&typeof h!="function")throw new Error("task callback must be a function");if(i.started=!0,f(u)||(u=[u]),u.length===0)return n.setImmediate(function(){i.drain()});r(u,function(r){var u={data:r,priority:e,callback:typeof h=="function"?h:t};i.tasks.splice(s(i.tasks,u,o)+1,0,u);i.tasks.length===i.concurrency&&i.saturated();n.setImmediate(i.process)})}var e=n.queue(i,u);return e.push=function(n,t,i){h(e,n,t,i)},delete e.unshift,e};n.cargo=function(n,t){return et(n,1,t)};n.log=ot("log");n.dir=ot("dir");n.memoize=function(t,r){function e(){var o=i(arguments),s=o.pop(),e=r.apply(null,o);e in f?n.nextTick(function(){s.apply(null,f[e])}):e in u?u[e].push(s):(u[e]=[s],t.apply(null,o.concat([function(){var t,n,r;for(f[e]=i(arguments),t=u[e],delete u[e],n=0,r=t.length;n<r;n++)t[n].apply(null,arguments)}])))}var f={},u={};return r=r||function(n){return n},e.memo=f,e.unmemoized=t,e};n.unmemoize=function(n){return function(){return(n.unmemoized||n).apply(null,arguments)}};n.times=st(n.map);n.timesSeries=st(n.mapSeries);n.timesLimit=function(t,i,r,u){return n.mapLimit(g(t),i,r,u)};n.seq=function(){var r=arguments;return function(){var e=this,u=i(arguments),f=u.slice(-1)[0];typeof f=="function"?u.pop():f=t;n.reduce(r,u,function(n,t,r){t.apply(e,n.concat([function(){var n=arguments[0],t=i(arguments,1);r(n,t)}]))},function(n,t){f.apply(e,[n].concat(t))})}};n.compose=function(){return n.seq.apply(null,Array.prototype.reverse.call(arguments))};n.applyEach=function(){var t=i(arguments);return ht.apply(null,[n.eachOf].concat(t))};n.applyEachSeries=function(){var t=i(arguments);return ht.apply(null,[n.eachOfSeries].concat(t))};n.forever=function(n,i){function r(n){if(n)return u(n);f(r)}var u=h(i||t),f=b(n);r()};n.ensureAsync=b;typeof module!="undefined"&&module.exports?module.exports=n:typeof define!="undefined"&&define.amd?define([],function(){return n}):s.async=n})();
//# sourceMappingURL=async.min.js.map
